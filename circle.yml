machine:
  timezone:
    Europe/Moscow    
 
test:
   override:
     - lein ring uberwar

deployment:
  pre:
    - rm -rf $CIRCLE_PROJECT_REPONAME/src
    - rm -rf $CIRCLE_PROJECT_REPONAME/project.clj
    - rm -rf $CIRCLE_PROJECT_REPONAME/README.md
    - rm -rf $CIRCLE_PROJECT_REPONAME/.git*
    - rm -rf $CIRCLE_PROJECT_REPONAME/circle.yml
              
  staging:
    branch: master
    codedeploy:
      hello-circleci:
        application_root: /
        revision_location:
          revision_type: S3
          s3_location:
            bucket: circleci-test
            key_pattern: hello-circleci/hello-circleci-{SHORT_COMMIT}-{BUILD_NUM}.zip
        region: us-west-2
        deployment_group: CircleCI-Deployment
        deployment_config: CodeDeployDefault.OneAtATime